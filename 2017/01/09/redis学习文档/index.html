<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> REDIS 学习(nodejs版) · 金缮的随笔</title><meta name="description" content="REDIS 学习(nodejs版) - 晓松"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="yexiaosong.github.io/atom.xml" title="金缮的随笔"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="金缮的随笔" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">金缮的随笔</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>主页</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>归档</p></a><a href="/about" target="_self" class="li component-nav-item"><p>关于</p></a><ul class="shortcut-icons"><a href="https://github.com/yexiaosong" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="https://www.zhihu.com/people/yexiaosong" target="_blank"><img src="/images/zhihu.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">REDIS 学习(nodejs版)</h1><div class="post-info">2017年1月9日</div><div class="post-content"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>redis是一个高效的内存key-value数据库，而且可以刷至磁盘</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>电脑安装sudo apt install redis </li>
<li>node添加链接中间件 npm install redis<h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> redis = <span class="built_in">require</span>(<span class="string">'redis'</span>);</span><br><span class="line"><span class="keyword">var</span> client = redis.createClient(<span class="number">6379</span>, <span class="string">'localhost'</span>);</span><br><span class="line">client.set(<span class="string">'hello'</span>, <span class="string">'first redis demo'</span>);</span><br><span class="line">client.get(<span class="string">'hello'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, v</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'the hello value is: '</span>, err, v)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
如果在createClient的时候传入对象，则保存为字符串。默认调用toString()方法。在后续版本中将报错<h3 id="list列表操作-插入元素"><a href="#list列表操作-插入元素" class="headerlink" title="list列表操作(插入元素)"></a>list列表操作(插入元素)</h3></li>
<li>lpush rpush…插入操作</li>
<li>lrange 读取操作，默认lrange(0,-1)就表示从左取到右<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接上述入门程序</span></span><br><span class="line">client.lpush(<span class="string">'testLists'</span>, <span class="string">'2'</span>);</span><br><span class="line">client.lpush(<span class="string">'testLists'</span>, <span class="string">'3'</span>);</span><br><span class="line">client.lpush(<span class="string">'testLists'</span>, <span class="string">'4'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(client.lrange(<span class="string">'testLists'</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, list</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"the content: "</span>, list);</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure></li>
<li>lpop左出栈</li>
<li>rpop右出栈<h3 id="set集合操作-插入不重复数据"><a href="#set集合操作-插入不重复数据" class="headerlink" title="set集合操作(插入不重复数据)"></a>set集合操作(插入不重复数据)</h3></li>
<li>sadd集合添加数据</li>
<li>smember取出集合中的数据<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">client.sadd(<span class="string">'testSet'</span>, <span class="string">'10'</span>)</span><br><span class="line">client.sadd(<span class="string">'testSet'</span>, <span class="string">'20'</span>)</span><br><span class="line">client.sadd(<span class="string">'testSet'</span>, <span class="string">'30'</span>)</span><br><span class="line"></span><br><span class="line">client.smembers(<span class="string">'testSet'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, v</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'the set content: '</span>, err, v);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="消息中介"><a href="#消息中介" class="headerlink" title="消息中介"></a>消息中介</h3></li>
<li>publish发送消息</li>
<li>subscribe接受消息<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//publish.js</span></span><br><span class="line">client.publish(<span class="string">'testPublish'</span>,<span class="string">'111222333'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//subscribe.js</span></span><br><span class="line">client.subscribe(<span class="string">'testPublish'</span>)</span><br><span class="line">client.on(<span class="string">'message'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">channel,msg</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(channel,msg)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//on事件必须绑定message事件，每当pub放推个消息，sub端都会手动，可一次作为进程间的通信</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</div></article></div></div></main><footer class="footer-container"><div class="paginator"><a href="/2017/01/11/mongoose%E5%AD%A6%E4%B9%A0/" class="prev">上一篇</a><a href="/2016/10/07/node%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="next">下一篇</a></div><div class="copyright"><p>© 2017 - 2021 <a href="yexiaosong.github.io">晓松</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer></body></html>