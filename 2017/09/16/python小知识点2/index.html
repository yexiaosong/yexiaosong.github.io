<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> python核心知识点2 · 金缮的随笔</title><meta name="description" content="python核心知识点2 - 晓松"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="yexiaosong.github.io/atom.xml" title="金缮的随笔"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="金缮的随笔" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">金缮的随笔</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>主页</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>归档</p></a><a href="/about" target="_self" class="li component-nav-item"><p>关于</p></a><ul class="shortcut-icons"><a href="https://github.com/yexiaosong" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="https://www.zhihu.com/people/yexiaosong" target="_blank"><img src="/images/zhihu.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">python核心知识点2</h1><div class="post-info">2017年9月17日</div><div class="post-content"><h2 id="python作用域"><a href="#python作用域" class="headerlink" title="python作用域"></a>python作用域</h2><h3 id="global"><a href="#global" class="headerlink" title="global"></a>global</h3><p>可以在定义变量的前面加上global，这样可以覆盖掉全局变量</p>
<h3 id="locals"><a href="#locals" class="headerlink" title="locals()"></a>locals()</h3><p>打印局部变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">()</span>:</span></span><br><span class="line">    age = <span class="number">22</span></span><br><span class="line">    name = <span class="string">'Jack'</span></span><br><span class="line">    print(locals())</span><br></pre></td></tr></table></figure>
<h2 id="types-MethodType"><a href="#types-MethodType" class="headerlink" title="types.MethodType"></a>types.MethodType</h2><p>可以实现动态添加方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> types</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_grade</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> self.score &gt;=<span class="number">80</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'A'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'B'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stu</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span></span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">s1 = Stu(<span class="string">'Alex'</span>,<span class="number">100</span>)</span><br><span class="line">s1.get_grade = types.MethodType(get_grade, s1, Stu)</span><br><span class="line"><span class="keyword">print</span> s1.get_score()</span><br><span class="line"></span><br><span class="line">如果不采用这种方式，直接调用get_score方法，则会报出Attribute的错误</span><br></pre></td></tr></table></figure>
<h2 id="创建类"><a href="#创建类" class="headerlink" title="创建类"></a>创建类</h2><p>type关键词一方面可以用来显示属性，另一方面可以动态创建属性。<br>实质上，type是在python中创建类的最初元类，可以使用<strong>class</strong>属性查看父类，类似于js的<strong>proto</strong>，在各种类的尽头都是type</p>
<h3 id="使用type动态创建类"><a href="#使用type动态创建类" class="headerlink" title="使用type动态创建类"></a>使用type动态创建类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"----eat----"</span>)</span><br><span class="line">Dog = type(<span class="string">"Dog"</span>,(Animal,),&#123;&#125;)</span><br><span class="line">其中type后的第一个参数为类名(字符串)，第二个为继承元素(元组)，第三个为类中的属性(字典)。</span><br></pre></td></tr></table></figure>
<h3 id="metaclass属性"><a href="#metaclass属性" class="headerlink" title="metaclass属性"></a><strong>metaclass</strong>属性</h3><p>这个属性是python中定义类的一种拦截方式，因为在python中定义类时，首先会寻找本创建对象中有没有<strong>metaclass</strong>属性，如果有会根据里面的设置创建类。如果没有回去父类中，然后模块中，然后内置的type。初学用不到，后期补充</p>
<h3 id="slots"><a href="#slots" class="headerlink" title="slots"></a><strong>slots</strong></h3><p>由于动态语言的动态性能，导致实例的类和属性不可控，所以，可以使用<strong>slot</strong>来限制可以定义的属性，例如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stu</span><span class="params">(object)</span>:</span></span><br><span class="line">    __slot__ = (<span class="string">'name'</span>,<span class="string">'age'</span>)</span><br><span class="line">s1 = Stu()</span><br><span class="line">s1.name = <span class="string">'Jack'</span></span><br><span class="line">s1.age = <span class="number">22</span></span><br><span class="line">s1.sex = 'male'-----&gt;报错，AttributeError</span><br></pre></td></tr></table></figure>
<p>但是此属性只对当前类的实例有作用，对继承的类没作用。</p>
<h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><p>python以引用计数为主，标记清除和分代收集两种机制为辅。</p>
<h3 id="小整数池"><a href="#小整数池" class="headerlink" title="小整数池"></a>小整数池</h3><p>范围在[-5,256]的数值，在python对象创建时已经创建了。所以在定义一系列值为1时，id都为一致的。<br>同理有字符串等</p>
<blockquote>
<p>详细GC机制不在总结，用到时再总结。</p>
</blockquote>
<h2 id="内建属性及方法"><a href="#内建属性及方法" class="headerlink" title="内建属性及方法"></a>内建属性及方法</h2><h3 id="常用内建属性"><a href="#常用内建属性" class="headerlink" title="常用内建属性"></a>常用内建属性</h3><ul>
<li><strong>init</strong> 构造初始化函数，创建实例后，赋值时使用。再<strong>new</strong>之后</li>
<li><strong>new</strong> 创建实例时调用</li>
<li><strong>str</strong> 实例字符串表示，突出可读性，如print</li>
<li><strong>repr</strong> 实例字符串表示，突出准确性</li>
<li><strong>del</strong> 引用计数为零的时候调用</li>
<li><strong>doc</strong> 类文档，使用help时调用</li>
<li><strong>class</strong> 实例所在的类</li>
<li><strong>getattribute</strong> 属性拦截器，类比于JavaScript中Object.defineProperty中的getter, 再<strong>getattribute</strong>中，不要使用self属性，可能会报错</li>
</ul>
<h3 id="常用内建方法"><a href="#常用内建方法" class="headerlink" title="常用内建方法"></a>常用内建方法</h3><ul>
<li>range() </li>
<li>map 函数，类比js中的map</li>
<li>filter ，类比js中的filter</li>
<li>reduce</li>
<li>set</li>
</ul>
</div></article></div></div></main><footer class="footer-container"><div class="paginator"><a href="/2017/09/20/%E6%96%B9%E5%90%91%E9%80%89%E6%8B%A9/" class="prev">上一篇</a><a href="/2017/09/14/python%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" class="next">下一篇</a></div><div class="copyright"><p>© 2017 - 2020 <a href="yexiaosong.github.io">晓松</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer></body></html>